<section class="searchSection">
    Creating a new astronaut is quick and easy!
    <button class="primary" type="button" (click)="showNewAstronautForm()">Add New Astronaut</button>
</section>

@if (isAddingNewAstronaut) {
<div class="newAstronautWrapper">
    <p>Adding a new astronaut is a quick 2-step process.</p>

    <div class="stepWrapper">
        <div class="stepMenu">
            <div [ngClass]="isInAddingStep1 ? 'currentStep' : 'otherStep'">
                Step 1: Add a new astronaut
            </div>
            <div [ngClass]="isInAddingStep2 ? 'currentStep' : 'otherStep'">
                Step 2: Add a duty record
            </div>
        </div>
        <div class="stepActivity">
            <div class="step1" *ngIf="isInAddingStep1">
                <label>
                    Enter the new astronaut's name, then:<br/><br/>&#149;&nbsp;&nbsp;click the <i>Add Astronaut and Continue</i> button to create the
                    astronaut and continue to add a duty record<br/><br/>or<br/><br/>&#149;&nbsp;&nbsp;click the <i>Add Astronaut and Finish</i> button to simply
                    create the astronaut
                </label>
                <div class="controlWrapper">
                    <label>Astronaut Name</label>
                    <input id="newAstronautName" name="newAstronautName" type="text" placeholder="Astronaut Name"
                        [(ngModel)]="newAstronaut.name" (keyup.enter)="addNewAstronautThenDuty()" />
                </div>
                <div class="actions">
                    <button class="primary" type="button" (click)="addNewAstronautThenDuty()">Add Astronaut and Continue</button>
                    <button class="primary" type="button" (click)="addNewAstronaut()">Add Astronaut and Finish</button>
                    <button class="secondary" type="button" (click)="cancelNewAstronautProcess()">Cancel</button>
                </div>
            </div>

            <div class="step2" *ngIf="isInAddingStep2">
                <label>Populate the duty record fields for <b>{{ newAstronaut.name }}</b>, then click the <i>Add Duty Record</i> button.</label>
                <input id="newAstronautDutyName" name="newAstronautDutyName" type="hidden"
                    [(ngModel)]="newAstronautDuty.name" disabled />
                <div class="controlWrapper">
                    <label>Duty Rank</label>
                    <input id="newAstronautDutyRank" name="newAstronautDutyRank" type="text"
                        placeholder="Astronaut Rank" [(ngModel)]="newAstronautDuty.rank" />
                </div>
                <div class="controlWrapper">
                    <label>Duty Title</label>
                    <input id="newAstronautDutyTitle" name="newAstronautDutyTitle" type="text"
                        placeholder="Astronaut Duty Title" [(ngModel)]="newAstronautDuty.dutyTitle"
                        (keyup.enter)="addAstronautDuty_NewAstronautProcess()" />
                </div>
                <div class="controlWrapper">
                    <label>Duty Start Date</label>
                    <input id="newAstronautDutyStartDate" name="newAstronautDutyStartDate" type="text"
                        placeholder="Astronaut Duty Start Date" [(ngModel)]="newAstronautDuty.dutyStartDate"
                        (keyup.enter)="addAstronautDuty_NewAstronautProcess()" />
                </div>
                <div class="actions">
                    <button class="primary" type="button" (click)="addAstronautDuty_NewAstronautProcess()">Add Duty
                        Record</button>
                    <button class="secondary" type="button" (click)="cancelNewAstronautProcess()">Skip</button>
                </div>
            </div>
        </div>
    </div>
</div>
} @else {
<div class="results">
    <label class="instructions">
        To view or create a new duty record, select an astronaut from the table below. The duty history and new duty
        form will then be displayed under the table.
    </label>

    <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border hover" data-page-length='5'>
    </table>

    @if (selectedAstronaut !== undefined && selectedAstronaut !== null) {
    <div class="detailsArea">
        <hr />
        <div class="detailsHeader">
            <span>{{ selectedAstronaut.name }}</span>
        </div>

        <div class="detailsAndDutyFormWrapper">
            <div class="astronautDetailsWrapper">
                <div class="dutyWrapper">
                    <div *ngIf="astronautDuties !== undefined">
                        <label class="listHeader">Duty history:</label>

                        @for (duty of astronautDuties; track $index) {
                        <div class="dutyList" [ngClass]="$index % 2 === 0 ? 'even' : 'odd'">
                            <span>{{ duty.rank }}</span>
                            <span>{{ duty.dutyTitle }}</span>
                            <span>
                                <span>Duty State Date:</span><span>{{ duty.dutyStartDate | date: 'MM/dd/yyyy' }}</span>
                                @if (duty.dutyEndDate !== undefined && duty.dutyEndDate !== null) {
                                <span>Duty End Date:</span><span>{{ duty.dutyEndDate | date: 'MM/dd/yyyy' }}</span>
                                }
                            </span>
                        </div>
                        }
                    </div>
                </div>
            </div>
            <div class="astronautDutyFormWrapper">
                @if (newAstronautDutyFormVisible) {
                <form class="newDutyForm">
                    <div>
                        <label>Create a new duty record for {{ selectedAstronaut.name }}:</label>

                        <div>
                            <label>Rank</label>
                            <input id="newDuty_newAstronautDutyRank" name="newDuty_newAstronautDutyRank" type="text"
                                placeholder="Astronaut Rank" [(ngModel)]="newAstronautDuty.rank" />
                        </div>
                        <div>
                            <label>Duty Title</label>
                            <input id="newDuty_newAstronautDutyTitle" name="newDuty_newAstronautDutyTitle" type="text"
                                placeholder="Astronaut Duty Title" [(ngModel)]="newAstronautDuty.dutyTitle"
                                (keyup.enter)="addAstronautDuty()" />
                        </div>
                        <div>
                            <label>Duty Start Date</label>
                            <input id="newDuty_newAstronautDutyStartDate" name="newDuty_newAstronautDutyStartDate"
                                type="text" placeholder="Astronaut Duty Start Date"
                                [(ngModel)]="newAstronautDuty.dutyStartDate" (keyup.enter)="addAstronautDuty()" />
                        </div>

                        <div>
                            <button class="primary" type="button" (click)="addAstronautDuty()">Add Duty Record</button>
                        </div>
                    </div>
                </form>
                }
            </div>
        </div>
    </div>
    }
</div>
}